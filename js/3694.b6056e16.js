"use strict";(self["webpackChunkwebide"]=self["webpackChunkwebide"]||[]).push([[3694],{3694:function(e,l,t){t.r(l),t.d(l,{default:function(){return $}});t(44114),t(18111),t(7588),t(61701),t(14603),t(47566),t(98721);var o=t(56768),a=t(45130),n=t(24232),i=t(90144);const u={class:"course-editor",style:{height:"100%","overflow-y":"auto"}},s={class:"form-section"},c={class:"form-group"},r={class:"form-group"},p={key:0,class:"video-preview"},d=["src"],v={class:"form-section"},k={class:"form-group"},h={class:"chapter-header"},m=["onUpdate:modelValue"],L=["onClick"],f={class:"form-group"},C=["onUpdate:modelValue"],b=["onClick"],g={class:"section-header"},U=["onUpdate:modelValue"],y=["onClick"],R={class:"form-group"},E=["onClick"],F={key:0},X={class:"form-group"},w=["onChange"],J={key:0},O={key:0,class:"code-files"},_=["onClick"],K={class:"form-section"},S={key:0,class:"json-preview"};var j=(0,o.pM)({__name:"CreateNewCourse",setup(e){const l=(0,i.KR)({title:"",chapters:[]}),t=(0,i.KR)(""),j=(0,i.KR)([]),V=(0,i.KR)(null),N=(0,i.KR)(null),$=(0,i.KR)(null),Q=e=>{const t=e.target.files;if(!t||0===t.length)return;const o=t[0],a=URL.createObjectURL(o);V.value=a,l.value.chapters.forEach((e=>{e.sections.forEach((e=>{e.videoPath=a}))}))},I=()=>{t.value.trim()&&(l.value.chapters.push({name:t.value,sections:[]}),j.value.push(""),t.value="")},M=e=>{l.value.chapters.splice(e,1),j.value.splice(e,1)},P=e=>{j.value[e].trim()&&(l.value.chapters[e].sections.push({name:j.value[e],codeFiles:[],videoPath:V.value}),j.value[e]="")},x=(e,t)=>{l.value.chapters[e].sections.splice(t,1)},A=(e,t)=>{if(!N.value)return;const o=Math.floor(N.value.currentTime);l.value.chapters[e].sections[t].timepoint=o},B=(e,t,o)=>{const a=o.target.files;if(!a||0===a.length)return;const n=a[0],i=URL.createObjectURL(n);l.value.chapters[e].sections[t].codeFiles.push({filename:n.name,file:n,fileUrl:i})},T=(e,t,o)=>{const a=l.value.chapters[e].sections[t].codeFiles[o];URL.revokeObjectURL(a.fileUrl),l.value.chapters[e].sections[t].codeFiles.splice(o,1)},W=()=>{const e={title:l.value.title,chapters:l.value.chapters.map(((e,l)=>({name:e.name,sections:e.sections.map(((e,l)=>({name:e.name,videoPath:e.videoPath||"",codeFiles:e.codeFiles.map(((l,t)=>({...l,timepoint:e.timepoint||0,codepath:`/code/${l.filename}`,inputpath:`/input/${l.filename.replace(/\.[^/.]+$/,"")}_input.txt`})))})))})))};$.value=e},q=()=>{if(!$.value)return;const e=JSON.stringify($.value,null,2),t=new Blob([e],{type:"application/json"}),o=document.createElement("a");o.href=URL.createObjectURL(t),o.download=`${l.value.title||"course"}.json`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(o.href)},z=e=>{const l=Math.floor(e/60),t=Math.floor(e%60);return`${l.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`};return(e,i)=>((0,o.uX)(),(0,o.CE)("div",u,[i[13]||(i[13]=(0,o.Lk)("h1",null,"创建新课程",-1)),(0,o.Lk)("div",s,[i[5]||(i[5]=(0,o.Lk)("h2",null,"课程基本信息",-1)),(0,o.Lk)("div",c,[i[2]||(i[2]=(0,o.Lk)("label",null,"课程标题:",-1)),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":i[0]||(i[0]=e=>l.value.title=e),placeholder:"输入课程标题"},null,512),[[a.Jo,l.value.title]])]),(0,o.Lk)("div",r,[i[4]||(i[4]=(0,o.Lk)("label",null,"上传课程视频:",-1)),(0,o.Lk)("input",{type:"file",onChange:Q},null,32),V.value?((0,o.uX)(),(0,o.CE)("div",p,[(0,o.Lk)("video",{ref_key:"videoRef",ref:N,controls:"",width:"640",height:"360"},[(0,o.Lk)("source",{src:V.value,type:"video/mp4"},null,8,d),i[3]||(i[3]=(0,o.eW)(" 您的浏览器不支持视频播放 "))],512)])):(0,o.Q3)("",!0)])]),(0,o.Lk)("div",v,[i[11]||(i[11]=(0,o.Lk)("h2",null,"课程结构",-1)),(0,o.Lk)("div",k,[i[6]||(i[6]=(0,o.Lk)("label",null,"章节名称:",-1)),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":i[1]||(i[1]=e=>t.value=e),placeholder:"输入章节名称"},null,512),[[a.Jo,t.value]]),(0,o.Lk)("button",{onClick:I},"添加章节")]),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(l.value.chapters,((e,l)=>((0,o.uX)(),(0,o.CE)("div",{key:l,class:"chapter-item"},[(0,o.Lk)("div",h,[(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":l=>e.name=l,placeholder:"章节名称"},null,8,m),[[a.Jo,e.name]]),(0,o.Lk)("button",{onClick:e=>M(l)},"删除",8,L)]),(0,o.Lk)("div",f,[i[7]||(i[7]=(0,o.Lk)("label",null,"小节名称:",-1)),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":e=>j.value[l]=e,placeholder:"输入小节名称"},null,8,C),[[a.Jo,j.value[l]]]),(0,o.Lk)("button",{onClick:e=>P(l)},"添加小节",8,b)]),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.sections,((e,t)=>((0,o.uX)(),(0,o.CE)("div",{key:t,class:"section-item"},[(0,o.Lk)("div",g,[(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":l=>e.name=l,placeholder:"小节名称"},null,8,U),[[a.Jo,e.name]]),(0,o.Lk)("button",{onClick:e=>x(l,t)}," 删除 ",8,y)]),(0,o.Lk)("div",R,[i[8]||(i[8]=(0,o.Lk)("label",null,"时间点标记:",-1)),(0,o.Lk)("button",{onClick:e=>A(l,t)}," 在当前时间添加标记 ",8,E),e.timepoint?((0,o.uX)(),(0,o.CE)("span",F,"当前标记: "+(0,n.v_)(z(e.timepoint)),1)):(0,o.Q3)("",!0)]),(0,o.Lk)("div",X,[i[9]||(i[9]=(0,o.Lk)("label",null,"代码文件:",-1)),(0,o.Lk)("input",{type:"file",onChange:e=>B(l,t,e)},null,40,w),e.codeFiles.length?((0,o.uX)(),(0,o.CE)("span",J,"已上传 "+(0,n.v_)(e.codeFiles.length)+" 个文件",1)):(0,o.Q3)("",!0)]),e.codeFiles.length?((0,o.uX)(),(0,o.CE)("div",O,[i[10]||(i[10]=(0,o.Lk)("h4",null,"代码文件列表:",-1)),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.codeFiles,((e,a)=>((0,o.uX)(),(0,o.CE)("div",{key:a,class:"code-file-item"},[(0,o.Lk)("span",null,(0,n.v_)(e.filename),1),(0,o.Lk)("button",{onClick:e=>T(l,t,a)}," 删除 ",8,_)])))),128))])):(0,o.Q3)("",!0)])))),128))])))),128))]),(0,o.Lk)("div",K,[(0,o.Lk)("button",{onClick:W},"生成JSON"),$.value?((0,o.uX)(),(0,o.CE)("div",S,[i[12]||(i[12]=(0,o.Lk)("h3",null,"生成的JSON:",-1)),(0,o.Lk)("pre",null,(0,n.v_)(JSON.stringify($.value,null,2)),1),(0,o.Lk)("button",{onClick:q},"下载JSON")])):(0,o.Q3)("",!0)])]))}}),V=t(71241);const N=(0,V.A)(j,[["__scopeId","data-v-1c8cf22e"]]);var $=N}}]);
//# sourceMappingURL=3694.b6056e16.js.map